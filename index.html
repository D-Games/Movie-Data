<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Gallery - Dmitry Popovichev</title>

    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/movieData.css">


    <script>
        window.addEventListener('load', function(){
          populateTable();
        });
      </script>

      <script>
        window.addEventListener('load', function(){
          addToTable();
        });
      </script>
</head>
<body>

    <div class="header-container" style="flex-direction: column;">
        <div class="inner-header">

            <div class="logo-container">
                <h1>MY<span>SITE</span></h1>
            </div>

            <ul class="navigation">
                <a href="#"><li>Home</li></a>
                <a href="#"><li>Hobby Page</li></a>
                <a href="#"><li>Project Gallery</li></a>
                <a href="#"><li>Movie Data</li></a>
                <a href="#"><li>About Me</li></a>
                <a href="#"><li>Game</li></a>
                <a href="#"><li>Contact</li></a>
            </ul>
        </div>
    </div>
    <div class="table-container">
        <div class="refresh-container">
            <button class="refresh" id="refresh" onclick="document.location.reload()"><div><img src="img/Refresh button.png" alt="refresh logo"></div>Refresh</button>
        </div>
        <table id="movie-table" class="movie-table">
            <thead>
                <tr>
                    <th onclick="sortTable(0, this)">Title<div class="data-sort"></div></th>
                    <th data-sort onclick="sortTable(1, this)">Year<div class="data-sort"></div></th>
                    <th data-sort onclick="sortTable(2, this)">Plot<div class="data-sort"></div></th>
                    <th data-sort onclick="sortTable(3, this)">Cast<div class="data-sort"></div></th>
                    <th data-sort onclick="sortTable(4, this)">Runtime<div class="data-sort"></div></th>
                    <th data-sort onclick="sortTable(5, this)">Rating<div class="data-sort"></div></th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button class="add-movie" onclick="openForm()">Add Movie</button>
    </div>
    <div class="form-box" id="form-box">
        <div class="form-title">Enter the movie data below</div>
        <div class="form-container">
            <form>
                <div>
                    <label for="title">Movie Title</label>
                    <input type="text" id="title" name="title" placeholder="Fast & Furious: Tokyo Drift" style="width: 300px;">
                </div>    
                <div>
                    <label for="year">Release Year</label>
                    <input type="number" id="year" name="year" placeholder="Year" value="2023" style="width: 130px">
                </div>
                <div>    
                    <label for="plot">Plot Description</label>
                    <textarea id="plot" name="plot" placeholder="Description" rows="4" cols="70"></textarea>
                </div>    
                <div>    
                    <label for="cast">Cast</label>
                    <input type="text" id="cast" name="cast" placeholder="John Snow, Keannu Reaves" style="width: 300px">
                </div>
                <div>  
                    <label for="runtime">Runtime (mins)</label>
                    <input type="number" id="runtime" name="runtime" placeholder="151" style="width: 130px">
                </div>
                <div>    
                    <label for="rating">Rating</label>
                    <input type="text" id="rating" name="rating" placeholder="7.1" style="width: 100px">
                </div>
                <div class="form-submit">
                    <button id="submit" class="submit" type="submit">Submit</button> 
                </div>
                <div class="form-close">
                    <button id="close" class="close" onclick="closeForm()">close</button> 
                </div>
            </form>
        </div>
    </div>

    <script>

        /*const form = document.querySelector('form');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const fd = new FormData(form);
            
            const obj = Object.fromEntries(fd);

        })*/

        let movies = [];

        const addMovie = (ev)=>{
            ev.preventDefault();
            let movie = {
                title: document.getElementById('title').value,
                year: document.getElementById('year').value,
                plot: document.getElementById('plot').value,
                cast: document.getElementById('cast').value,
                runtime: document.getElementById('runtime').value,
                rating: document.getElementById('rating').value
            }

            movies.push(movie);
            document.querySelector('form').reset();

            console.warn('added', {movies} );

            localStorage.setItem('MovieList', JSON.stringify(movies));
        }

        document.addEventListener ('DOMContentLoaded', ()=>{
            document.getElementById('submit').addEventListener('click', addMovie);
            document.getElementById('submit').addEventListener('click', closeForm);
        });

        function closeForm() {
            document.getElementById('form-box').style.display = 'none';
        }

        /*document.addEventListener ('DOMContentLoaded', ()=>{
            document.getElementById('submit').addEventListener('click', ()=> {
                document.getElementById('form-box').style.display = 'none';
            });
        });*/
    </script>

    <footer class="footer">
       <div class="social-container">
          <nav class="linkedin-icon"></nav>
          <nav class="artstation-icon"></nav>
          <nav class="facebook-icon"></nav>
          <nav class="instagram-icon"></nav>
          <nav class="twitter-icon"></nav>
        </div>
    </footer>

    <script src="js/movieData.js"></script>
</body>
</html>